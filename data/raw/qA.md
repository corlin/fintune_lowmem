# 基于GB/T 39786-2021的密码应用QA对

## 基础概念类

### Q1: 什么是信息系统密码应用的基本要求？

A1: 信息系统密码应用基本要求是指从信息系统的物理和环境安全、网络和通信安全、设备和计算安全、应用和数据安全四个技术层面提出的密码应用技术要求，以及从管理制度、人员管理、建设运行和应急处置四个方面提出的密码应用管理要求。

### Q2: 本标准中提到的密码安全功能维度有哪些？

A2: 本标准中提到的密码安全功能维度包括：机密性、完整性、真实性、不可否认性四个维度。

### Q3: 什么是密钥管理？

A3: 密钥管理是指根据安全策略，对密钥的产生、分发、存储、使用、更新、归档、撤销、备份、恢复和销毁等密钥全生存周期的管理。

## 技术要求类

### Q4: 第一级密码应用在物理和环境安全方面有哪些要求？

A4: 第一级要求包括：

1. 可采用密码技术进行物理访问身份鉴别，保证重要区域进入人员身份的真实性；
2. 可采用密码技术保证电子门禁系统进出记录数据的存储完整性；
3. 如采用密码服务，该密码服务应符合法律法规的相关要求。

### Q5: 第三级密码应用在网络和通信安全方面有哪些具体要求？

A5: 第三级要求包括：

1. 应采用密码技术对通信实体进行身份鉴别；
2. 宜采用密码技术保证通信过程中数据的完整性；
3. 应采用密码技术保证通信过程中重要数据的机密性；
4. 宜采用密码技术保证网络边界访问控制信息的完整性；
5. 可采用密码技术对从外部连接到内部网络的设备进行接入认证。

### Q6: 第四级密码应用在设备和计算安全方面与第三级有何不同？

A6: 第四级比第三级要求更严格，主要体现在：

1. 应采用密码技术保证系统资源访问控制信息的完整性（第三级是"宜"）；
2. 应采用密码技术保证设备中的重要信息资源安全标记的完整性（第三级是"宜"）；
3. 应采用密码技术保证日志记录的完整性（第三级是"宜"）；
4. 应采用密码技术对重要可执行程序进行完整性保护并验证来源真实性（第三级是"宜"）。

## 管理要求类

### Q7: 第二级密码应用在人员管理方面有哪些要求？

A7: 第二级人员管理要求包括：

1. 相关人员应了解并遵守密码相关法律法规、密码应用安全管理制度；
2. 应建立密码应用岗位责任制度；
3. 应建立上岗人员培训制度；
4. 应建立关键人员保密制度和调离制度。

### Q8: 第三级密码应用在建设运行方面有哪些特殊要求？

A8: 第三级建设运行要求包括：

1. 投入运行前应进行密码应用安全性评估，评估通过后系统方可正式运行；
2. 在运行过程中应严格执行密码应用安全管理制度；
3. 应定期开展密码应用安全性评估及攻防对抗演习，并根据评估结果进行整改。

### Q9: 第四级密码应用在应急处置方面与第三级有何区别？

A9: 主要区别在于：

1. 第四级要求事件发生后应及时向信息系统主管部门及归属的密码管理部门进行报告（第三级只需向信息系统主管部门报告）；
2. 第四级要求事件处置完成后应及时向信息系统主管部门及归属的密码管理部门报告（第三级同样要求）。

## 实施与评估类

### Q10: 信息系统密码应用等级是如何划分的？

A10: 信息系统密码应用划分为五个等级，从低到高依次为第一级到第五级。第一级是最低等级，第五级是最高等级（标准中未详细描述第五级要求）。各等级密码保障能力逐级增强。

### Q11: 密码产品安全要求等级是如何对应的？

A11: 标准中要求：

1. 第二级密码应用采用的密码产品应达到GB/T 37092一级及以上安全要求；
2. 第三级应达到二级及以上安全要求；
3. 第四级应达到三级及以上安全要求。

### Q12: 密钥生存周期管理包括哪些环节？

A12: 密钥生存周期管理包括：密钥的产生、分发、存储、使用、更新、归档、撤销、备份、恢复和销毁等环节。



## 深入理解类

### Q13: 为什么密码应用要分为四个技术层面和四个管理维度？

A13: 这种划分基于全面防护的理念：

1. 四个技术层面（物理和环境安全、网络和通信安全、设备和计算安全、应用和数据安全）覆盖了信息系统从底层基础设施到上层应用的全栈安全需求
2. 四个管理维度（管理制度、人员管理、建设运行、应急处置）则从组织管理角度确保密码应用的有效实施和持续运营
3. 这种"技术+管理"的框架设计符合网络安全"三同步"原则，实现全方位防护

### Q14: 标准中"应"和"宜"的表述有什么区别？在实施中如何把握？

A14: 这是标准中的规范用语：

1. "应"表示强制性要求，是必须满足的基本要求（对应shall）
2. "宜"表示推荐性要求，在条件允许时应尽量满足（对应should）
3. 实施时应优先确保所有"应"条款的合规，在此基础上根据风险评估结果决定"宜"条款的实施程度
4. 高等级系统通常需要实现更多"宜"的要求

## 实践应用类

### Q15: 在实施第三级密码应用时，如何设计合理的密钥管理体系？

A15: 第三级密钥管理应：

1. 根据密码应用方案明确系统涉及的密钥种类和体系
2. 对每类密钥实施全生命周期管理（参照附录B）
3. 关键措施包括：
    - 在符合GB/T 37092二级的密码产品中产生密钥
    - 采用安全通道分发密钥
    - 密钥不以明文方式存储在密码产品外部
    - 为密钥设置合理的使用期限和更新策略
    - 建立密钥备份恢复机制
4. 特别要注意不同密钥的用途隔离和权限控制

### Q16: 如何理解第四级密码应用中"应采用密码技术提供数据原发证据和数据接收证据"的要求？

A16: 这项要求指：

1. 在可能涉及法律责任的业务场景中（如电子合同、交易指令等）
2. 必须使用数字签名等密码技术实现：
    - 数据原发行为的不可否认性（发方不能否认发送过）
    - 数据接收行为的不可否认性（收方不能否认接收过）
3. 典型实现方式：
    - 采用基于SM2等算法的数字签名
    - 签名数据应包含时间戳等防重放要素
    - 签名私钥应由专用密码设备保护

### Q17: 密码应用安全性评估应该包含哪些重点内容？

A17: 评估应重点关注：

1. 密码算法合规性：是否采用国家批准的密码算法
2. 密码产品合规性：是否使用通过认证的密码产品
3. 密钥管理安全性：密钥全生命周期管理是否规范
4. 密码协议安全性：通信协议设计是否安全
5. 实现安全性：密码功能实现是否存在漏洞
6. 管理有效性：管理制度和流程是否健全
7. 对于第三级以上系统，还应评估抗攻击能力

## 特殊场景类

### Q18: 对于云计算环境，密码应用有哪些特殊考虑？

A18: 云环境需特别注意：

1. 密钥存储安全：避免云服务商接触明文密钥
2. 密钥隔离：确保不同租户密钥严格隔离
3. 虚拟化安全：密码模块的虚拟化实现应符合GB/T 37092
4. 跨云通信：建立安全的跨云密钥分发机制
5. 云密码服务：使用通过认证的云密码服务
6. 特别注意满足标准中"设备和计算安全"层面的要求

### Q19: 物联网系统中如何落实密码应用基本要求？

A19: 物联网系统实施要点：

1. 轻量化实现：选择适合终端设备的轻量级密码算法
2. 安全引导：确保设备固件的完整性验证
3. 密钥预置：安全地预置设备初始密钥
4. 安全更新：建立安全的固件更新机制
5. 通信安全：实现终端与网关间的双向认证
6. 特别注意满足标准中"网络和通信安全"层面的要求

### Q20: 在等保2.0框架下，如何协调密码应用基本要求与等级保护要求？

A20: 协调实施要点：

1. 密码应用基本要求是对等保2.0中密码要求的细化补充
2. 实施时应：
    - 先确定系统等保定级（1-5级）
    - 选择对应等级的密码应用要求
    - 将密码要求融入整体安全设计方案
3. 特别注意：
    - 等保通用要求中的密码条款
    - 行业等保扩展要求中的特殊密码规定
    - 密码应用测评与等保测评的协同开展



## 技术实现类

### Q21: 如何实现标准要求的"重要数据存储完整性"保护？

A21: 实现方案应包括：

1. 技术选择：
    - 采用SM3等密码杂凑算法生成数据摘要
    - 或使用SM4等对称算法生成MAC（消息认证码）
    - 对关键数据可结合数字签名技术
2. 实施要点：
    - 存储数据时同步生成并存储完整性校验值
    - 读取数据时重新计算并验证校验值
    - 校验值应与应用数据同等保护级别
3. 典型场景：
    - 数据库敏感字段完整性保护
    - 重要文件完整性校验
    - 系统配置完整性检查

### Q22: 远程管理设备时如何建立符合标准的安全传输通道？

A22: 安全通道建设要点：

1. 协议选择：
    - 采用SSL/TLS协议（需使用国密套件）
    - 或IPSec VPN等安全隧道技术
2. 必需的安全机制：
    - 双向身份认证（如基于数字证书）
    - 会话密钥协商机制
    - 数据加密传输（如SM4）
    - 完整性保护（如SM3-HMAC）
3. 特别要求：
    - 第三级以上系统必须实现
    - 密码模块应达到相应安全等级要求
    - 密钥管理符合标准附录B要求

## 管理实践类

### Q23: 如何制定符合第四级要求的密码应用安全管理制度？

A23: 制度制定要点：

1. 必须包含的核心制度：
    - 密码人员岗位责任制度
    - 密钥全生命周期管理制度
    - 密码设备管理制度
    - 应急响应预案
2. 高阶要求：
    - 建立制度评审机制（至少每年一次）
    - 制定详细的密码操作规程
    - 建立执行记录留存机制（至少保存6个月）
3. 特殊规定：
    - 关键岗位需多人共管
    - 密码安全审计独立进行
    - 背景调查制度

### Q24: 密码应用岗位设置有哪些具体要求？

A24: 岗位设置要求：

1. 基本岗位：
    - 密钥管理员：负责密钥管理
    - 密码操作员：负责日常密码操作
    - 密码安全审计员：负责监督审计
2. 高阶要求：
    - 第三级开始要求岗位分离
    - 第四级要求关键岗位内部人员担任
3. 权限控制：
    - 不得共用操作账号
    - 实施最小权限原则
    - 操作需双人复核（第四级）

## 测评验证类

### Q25: 如何验证密码产品是否符合GB/T 37092相应等级要求？

A25: 验证方法：

1. 官方认证：
    - 检查密码产品是否获得国家密码管理局颁发的型号证书
    - 确认证书载明的安全等级符合要求
2. 技术验证：
    - 二级以上产品应具备物理安全防护
    - 三级产品需验证防旁路攻击能力
    - 确认密码模块边界清晰
3. 特别注意：
    - 不得使用未经认证的密码产品
    - 不同等级系统对应不同产品等级要求

### Q26: 密码应用安全性评估的主要测试方法有哪些？

A26: 常用测试方法：

1. 文档审查：
    - 检查密码应用方案
    - 验证密钥管理策略
2. 配置检查：
    - 密码算法配置核查
    - 密码协议参数检查
3. 功能测试：
    - 加解密功能验证
    - 数字签名验证
4. 渗透测试：
    - 针对密码实现的漏洞扫描
    - 模拟攻击测试
5. 管理审核：
    - 制度执行情况检查
    - 人员访谈

## 前沿趋势类

### Q27: 在后量子密码时代，如何保证现有密码应用体系的可持续性？

A27: 过渡策略建议：

1. 算法层面：
    - 关注国家密码管理局发布的抗量子算法
    - 逐步实施算法敏捷性架构
2. 系统设计：
    - 采用混合密码体系
    - 预留算法升级接口
3. 密钥管理：
    - 缩短关键系统密钥更新周期
    - 加强密钥隔离保护
4. 标准跟踪：
    - 密切关注GB/T系列标准更新
    - 及时调整实施方案

### Q28: 区块链技术如何满足密码应用基本要求？

A28: 区块链合规要点：

1. 密码算法：
    - 必须采用国密算法（SM2/SM3/SM4）
    - 替换原有非国密算法
2. 密钥管理：
    - 实现符合标准的密钥生命周期管理
    - 用户私钥安全存储方案
3. 智能合约：
    - 合约代码完整性保护
    - 执行环境安全隔离
4. 特别注意事项：
    - 共识机制的安全性证明
    - 交易数据的隐私保护

## 行业实践类

### Q29: 金融行业实施密码应用有哪些特殊要求？

A29: 金融行业特殊要求：

1. 监管要求：
    - 需同时满足JR/T相关标准
    - 高风险系统需提高一个等级实施
2. 典型场景：
    - 支付交易必须实现不可否认性
    - 客户敏感数据加密存储
3. 特殊措施：
    - 金融IC卡密码应用规范
    - 密钥管理系统需通过专项认证
    - 实施HSM保护关键密钥

### Q30: 政务系统密码应用改造的典型路径是什么？

A30: 改造实施路径：

1. 规划阶段：
    - 确定系统密码应用等级
    - 编制密码应用方案
2. 建设阶段：
    - 部署通过认证的密码产品
    - 实施国密算法改造
    - 建立密钥管理体系
3. 运维阶段：
    - 定期开展密码应用评估
    - 建立应急响应机制
4. 典型改造点：
    - 电子公文数字签名
    - 政务数据加密传输
    - 统一身份认证平台



## 合规与法律类

### Q31: 密码应用基本要求与《密码法》的关系是什么？

A31: 两者的关系体现在：

1. 法律基础：
    - 《密码法》是上位法，规定了密码工作的基本原则和管理制度
    - GB/T 39786是具体技术标准，落实《密码法》要求
2. 实施关系：
    - 《密码法》要求"商用密码应用应当符合相关国家标准"
    - 本标准即为《密码法》引用的重要标准之一
3. 法律责任：
    - 违反本标准可能导致不符合《密码法》要求
    - 关键信息基础设施必须达到相应等级要求

### Q32: 跨境数据传输场景如何满足密码应用要求？

A32: 合规实施要点：

1. 加密要求：
    - 必须使用国家批准的密码算法
    - 密钥不得出境，应由境内主体控制
2. 特殊管理：
    - 建立跨境密钥管理机制
    - 重要数据需额外保护措施
3. 法律遵从：
    - 同时满足《数据安全法》《个人信息保护法》要求
    - 密码方案需通过主管部门安全评估

## 技术细节类

### Q33: 如何正确实现SM2算法的数字签名验证？

A33: 正确实现要点：

1. 参数选择：

    - 使用国家发布的标准曲线参数
    - 签名算法标识符正确设置

2. 实现流程：

    ```
    # 示例流程（伪代码）
    verify_signature(message, signature, public_key):
        hash = sm3(message)  # 计算消息摘要
        result = sm2_verify(hash, signature, public_key)
        return result == VERIFY_SUCCESS
    ```

3. 常见问题：

    - 避免摘要算法误用（必须用SM3）
    - 正确处理签名编码格式
    - 验证证书链有效性

### Q34: 密钥轮换策略应该如何制定？

A34: 策略制定指南：

1. 基本规则：
    - 对称密钥建议3-12个月轮换
    - 非对称密钥建议1-2年轮换
2. 特殊场景：
    - 高安全等级系统缩短周期50%
    - 密钥疑似泄露时立即轮换
3. 实施要点：
    - 建立密钥版本管理机制
    - 新旧密钥并行期设置（通常7-30天）
    - 归档旧密钥用于解密历史数据

## 运维管理类

### Q35: 密码安全审计应该记录哪些关键事件？

A35: 必须审计的事件包括：

1. 密钥管理事件：
    - 密钥生成、分发、销毁记录
    - 密钥导入导出操作
2. 密码操作事件：
    - 加解密操作（时间、主体、对象）
    - 签名验证操作
3. 管理事件：
    - 权限变更记录
    - 策略修改记录
4. 审计要求：
    - 记录需包含时间戳和操作者身份
    - 日志完整性保护
    - 至少保存6个月

### Q36: 如何安全地备份和恢复密钥？

A36: 安全操作指南：

1. 备份方案：
    - 使用专用加密设备备份
    - 分片存储（如Shamir秘密共享）
    - 离线介质多重备份
2. 恢复流程：
    - 需多人协同操作（至少双人控制）
    - 在安全环境中进行
    - 记录完整审计轨迹
3. 特别禁止：
    - 明文存储备份密钥
    - 单人完成恢复操作
    - 使用普通存储介质

## 新兴技术类

### Q37: 容器环境下如何满足密码应用要求？

A37: 容器安全要点：

1. 密钥管理：
    - 使用专门的密钥管理服务（KMS）
    - 避免在镜像中硬编码密钥
2. 运行时保护：
    - 使用安全容器技术
    - 隔离密码运算环境
3. 编排安全：
    - 加密容器间通信
    - 实施服务网格安全策略
4. 合规要求：
    - 密码模块仍需符合GB/T 37092
    - 保持密钥管理独立性

### Q38: 零信任架构中的密码应用如何实施？

A38: 实施路径：

1. 身份认证：
    - 基于SM2的数字证书体系
    - 多因素认证（结合SM4动态令牌）
2. 持续验证：
    - 短周期令牌（JWT使用SM3-HMAC）
    - 设备指纹加密传输
3. 数据传输：
    - 全程加密（SM4）
    - 微边界访问控制
4. 特别优势：
    - 符合"永不信任，持续验证"原则
    - 增强网络和通信安全层面防护

## 行业实践类

### Q39: 医疗健康数据如何分级实施密码保护？

A39: 分级保护方案：

1. 敏感级数据：
    - 必须存储加密（SM4）
    - 传输通道加密（SSL国密套件）
    - 实施细粒度访问控制
2. 一般级数据：
    - 传输加密
    - 存储可选择加密
3. 特殊要求：
    - 电子病历签名需达到三级要求
    - 基因数据需额外保护措施
4. 实施要点：
    - 符合《医疗卫生机构网络安全管理办法》
    - 密钥管理系统独立部署

### Q40: 车联网场景下如何满足密码应用要求？

A40: 车载安全方案：

1. 硬件基础：
    - 使用通过认证的车规级安全芯片
    - 实现HSM功能
2. 安全通信：
    - V2X通信使用SM2证书体系
    - 固件升级包数字签名
3. 密钥体系：
    - 分层密钥架构（主密钥->会话密钥）
    - 应急密钥销毁机制
4. 特殊挑战：
    - 低延迟要求下的密码运算优化
    - 应对无线环境的安全增强